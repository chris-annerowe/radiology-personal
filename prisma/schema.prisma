generator client {
  provider = "prisma-client-js"
  previewFeatures = ["fullTextSearch"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                     Int             @id @default(autoincrement())
  email                  String          @unique
  username               String          @unique
  password               String          @unique
  createdAt              DateTime        @default(now())
  modifiedConfigurations Configuration[]
}

model modality {
  modality_id              BigInt  @id @default(autoincrement())
  modality_code            String  @db.VarChar(10)
  application_entity_title String
  modality_description     String?
}

model modality_codes {
  modality_code        String    @unique @db.VarChar(10)
  modality_name        String
  modality_description String?
  studies              studies[]
}

model appointment {
  appointment_id   BigInt    @id @default(autoincrement())
  appointment_time DateTime? @db.Timestamp(6)
  patientid        String?   @db.VarChar(40)
  firstName        String?   @db.VarChar(40)
  lastName         String?   @db.VarChar(40)
  description      String?   @db.VarChar(240)
  modality         String?   @db.VarChar(20)
  dob              DateTime? @db.Timestamp(6)
  tel              String?   @db.VarChar(10)
  sex              String?   @db.VarChar(10)
  index            Int?
}

model order {
  order_number                    String        @id @db.VarChar(40)
  patient_id                      String?       @db.VarChar(40)
  payment_status                  String?       @db.VarChar
  balance_outstanding             Float?
  report_status                   String?       @db.VarChar
  report_zip_expiration_time      DateTime?     @db.Timestamp(6)
  report_zip_link_expiration_time DateTime?     @db.Timestamp(6)
  report_zip_link                 String?       @db.VarChar
  last_modified                   DateTime?     @default(now()) @db.Timestamp(6)
  order_studies                   order_study[]
}

model order_numbers {
  branch_code  String  @unique @db.VarChar
  order_number String? @db.VarChar
}

model patient {
  patient_id    String    @id @db.VarChar(40)
  patient_uid   String?   @db.VarChar(40)
  internalid    String?   @db.VarChar(15)
  id_type       String?   @db.VarChar(3)
  idnum         String?   @db.VarChar(40)
  first_name    String    @db.VarChar(60)
  last_name     String    @db.VarChar(60)
  other_name    String?   @db.VarChar(60)
  dob           DateTime? @db.Timestamp(6)
  address_1     String?   @db.VarChar(50)
  address_2     String?   @db.VarChar(50)
  city          String?   @db.VarChar(20)
  post_code     String?   @db.VarChar(25)
  parish        String?   @db.VarChar(25)
  height        Decimal?  @db.Decimal(10, 4)
  height_unit   String?   @db.VarChar(5)
  weight        Decimal?  @db.Decimal(10, 4)
  weight_unit   String?   @db.VarChar(5)
  telephone_1   String?   @db.VarChar(40)
  telephone_2   String?   @db.VarChar(40)
  fax           String?   @db.VarChar(40)
  cellular      String?   @db.VarChar(40)
  entry_date    DateTime? @db.Timestamp(6)
  next_kin      String?   @db.VarChar(255)
  guardian      String?   @db.VarChar(30)
  sex           String?   @db.VarChar(1)
  age           Int?
  months        Int?
  days          Int?
  branchcode    String?   @db.VarChar(3)
  title         String?   @db.VarChar(40)
  nationality   String?   @db.VarChar(2)
  inuse         Int?      @default(0)
  userid        Int?      @default(0)
  last_modified DateTime? @default(now()) @db.Timestamp(6)
  race          Int?      @default(1)
  email         String?   @db.VarChar(100)
  allergies     String?   @db.VarChar(255)
}

model patient_studies {
  id         BigInt @id @default(autoincrement())
  patient_id String @db.VarChar(40)
  study_name String? @db.VarChar(255)
  study_id   BigInt
  cpt_code   String?  @db.VarChar(5)
  isInsurable Boolean?
  isTaxable   Boolean?
}

model studies {
  study_id          BigInt         @id
  cpt_code          String         @db.VarChar(5)
  study_name        String?        @db.VarChar(255)
  study_description String?        @db.VarChar
  modality          modality_codes @relation(fields: [modality_code], references: [modality_code])
  modality_code     String         @map("modality_code")
  price             Float?
  order_studies     order_study[]
  isInsurable       Boolean?
  isTaxable         Boolean?
}

model order_study {
  order_study_id BigInt   @id @default(autoincrement())
  order          order    @relation(fields: [order_number], references: [order_number])
  order_number   String
  study          studies  @relation(fields: [study_id], references: [study_id])
  study_id       BigInt
  last_modified  DateTime @default(now())
}

model user {
  id        Int       @id
  email     String?   @unique @db.VarChar(50)
  username  String?   @unique @db.VarChar(50)
  password  String?   @db.VarChar(50)
  createdat DateTime? @default(now()) @db.Date
}

model worklist {
  worklist_id       BigInt  @id @default(autoincrement())
  accession_number  String? @db.VarChar(40)
  patient_uid       String? @db.VarChar(40)
  study_uid         String? @db.VarChar(40)
  study_description String? @db.VarChar
  study_date        String? @db.VarChar(8)
  study_time        String? @db.VarChar
  modality          String? @db.VarChar
  patient_name      String? @db.VarChar
  department        String? @db.VarChar
  patient_dob       String? @db.VarChar
  patient_gender    String? @db.VarChar(1)
}

model Configuration {
  configuration_id Int      @id
  serverHost       String   @map("server_host")
  serverPort       Int      @map("server_port")
  senderEmail      String   @map("sender_email")
  senderPassword   String   @map("sender_password")
  receiverEmail    String   @map("receiver_email")
  subject          String
  message          String
  updatedAt        DateTime @default(now()) @map("updated_at")
  modifiedBy       Int      @map("modified_by")
  modifier         User?    @relation(fields: [modifiedBy], references: [id])

  @@map("configuration")
}

//Point Of Sale Tables

model pos_insurance {
  insurance_id     String   @id @db.VarChar(5)
  insurance_name   String   @db.VarChar(100)
  user_id          Int
  last_modified    DateTime @default(now())
  in_use           Int      @default(0)
  ins_abbreviation String?  @db.VarChar(10)
  bin_nos          String?  @db.VarChar(100)
  bin_codes        String?  @db.VarChar(100)
}

// model pos_insurance {
//   insurance_id      BigInt  @id @default(autoincrement())
//   insurance_name    String  @db.VarChar(50)
//   insurance_abbrev  String  @db.VarChar(10)
// }

model pos_clientProviders_type {
  type_id         Int      @id @default(autoincrement())
  type_desc       String   @db.VarChar(50)
  user_id         Int
  last_modified   DateTime @default(now())

  pos_clientProviders pos_clientProviders[]
}

model pos_clientProviders {
  clientprov_id     BigInt  @id @default(autoincrement())
  clientprov_name   String  @db.VarChar(50)
  clientprov_desc   String  @db.VarChar(255)
  type   pos_clientProviders_type  @relation(fields: [clientprov_type], references: [type_id])
  clientprov_type   Int     @map("type_id")
  active            Boolean
}

model pos_payment_options {
  payment_type  String   @id @db.VarChar(10)
  name          String   @db.VarChar(50)
  abbreviation  String   @db.VarChar(15)
  id_required   Boolean
  user_id       Int
  last_modified DateTime @default(now())
}
